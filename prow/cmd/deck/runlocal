#!/usr/bin/env bash
# Copyright 2017 The Kubernetes Authors.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd $DIR
cd static
HOST="${HOST:-"https://prow.k8s.io"}"
curl "$HOST/data.js?var=allBuilds" > data.js
curl "$HOST/tide.js?var=tideData" > tide.js
curl "$HOST/plugin-help.js?var=allHelp" > plugin-help.js
curl "$HOST/branding.js?var=branding" > branding.js
echo '{"Login":true,"PullRequests":[{"Number":19200,"Merged":false,"Title":"Pre-rebase fixes","Author":{"Login":"liggitt"},"BaseRef":{"Name":"master","Prefix":"refs/heads/"},"HeadRefOID":"ddedeb56eba44cb09d643f9fca60fe15f539cc26","Repository":{"Name":"origin","NameWithOwner":"openshift/origin","Owner":{"Login":"openshift"}},"Labels":{"Nodes":[{"Label":{"ID":"MDU6TGFiZWwyMjMwNTEyOTQ=","Name":"approved"}},{"Label":{"ID":"MDU6TGFiZWwyMjM0NzkwODQ=","Name":"lgtm"}},{"Label":{"ID":"MDU6TGFiZWw2NDA1NDgzMDE=","Name":"size/M"}}]},"Milestone":{"ID":null,"Closed":false}},{"Number":19137,"Merged":false,"Title":"WIP - rebase 1.10.0","Author":{"Login":"liggitt"},"BaseRef":{"Name":"master","Prefix":"refs/heads/"},"HeadRefOID":"2d4f6e69c157c634646868d66da1e9589944ac1e","Repository":{"Name":"origin","NameWithOwner":"openshift/origin","Owner":{"Login":"openshift"}},"Labels":{"Nodes":[{"Label":{"ID":"MDU6TGFiZWwyMjMwNTEyOTQ=","Name":"approved"}},{"Label":{"ID":"MDU6TGFiZWw2ODYzODk5Nzg=","Name":"do-not-merge/work-in-progress"}},{"Label":{"ID":"MDU6TGFiZWw2NDA1NDg2NjI=","Name":"size/XXL"}}]},"Milestone":{"ID":null,"Closed":false}},{"Number":15158,"Merged":false,"Title":"WIP - consume groups from identity providers during login ","Author":{"Login":"liggitt"},"BaseRef":{"Name":"master","Prefix":"refs/heads/"},"HeadRefOID":"3a1a77efe373da3572950e9a0cfc0f58fa9f5dc7","Repository":{"Name":"origin","NameWithOwner":"openshift/origin","Owner":{"Login":"openshift"}},"Labels":{"Nodes":[{"Label":{"ID":"MDU6TGFiZWwyMjMwNTEyOTQ=","Name":"approved"}},{"Label":{"ID":"MDU6TGFiZWwyMTAxNzkyMDM=","Name":"area/security"}},{"Label":{"ID":"MDU6TGFiZWw2ODYzODk5Nzg=","Name":"do-not-merge/work-in-progress"}},{"Label":{"ID":"MDU6TGFiZWwzNjQ1MjMzODE=","Name":"needs-api-review"}},{"Label":{"ID":"MDU6TGFiZWwyNzY3MDgwMTI=","Name":"needs-rebase"}},{"Label":{"ID":"MDU6TGFiZWw2NDA1NDg2MTI=","Name":"size/XL"}}]},"Milestone":{"ID":null,"Closed":false}},{"Number":14566,"Merged":false,"Title":"WIP - Split cert generation tools into key-\u003ecsr-\u003esign-\u003everify-\u003epackage phases ","Author":{"Login":"liggitt"},"BaseRef":{"Name":"master","Prefix":"refs/heads/"},"HeadRefOID":"152f431a52adaee8b6229aa3084f66d91182f588","Repository":{"Name":"origin","NameWithOwner":"openshift/origin","Owner":{"Login":"openshift"}},"Labels":{"Nodes":[{"Label":{"ID":"MDU6TGFiZWwyMjMwNTEyOTQ=","Name":"approved"}},{"Label":{"ID":"MDU6TGFiZWw2ODYzODk5Nzg=","Name":"do-not-merge/work-in-progress"}},{"Label":{"ID":"MDU6TGFiZWw4MjUwODQ3MTU=","Name":"lifecycle/frozen"}},{"Label":{"ID":"MDU6TGFiZWw4MjY3NDU4NzY=","Name":"lifecycle/stale"}},{"Label":{"ID":"MDU6TGFiZWwyNzY3MDgwMTI=","Name":"needs-rebase"}},{"Label":{"ID":"MDU6TGFiZWw2NDA1NDg2NjI=","Name":"size/XXL"}}]},"Milestone":{"ID":null,"Closed":false}},{"Number":10050,"Merged":false,"Title":"hash access and authorize tokens","Author":{"Login":"liggitt"},"BaseRef":{"Name":"master","Prefix":"refs/heads/"},"HeadRefOID":"8735495cd5f17f9b8308da76998a5bf059025739","Repository":{"Name":"origin","NameWithOwner":"openshift/origin","Owner":{"Login":"openshift"}},"Labels":{"Nodes":[{"Label":{"ID":"MDU6TGFiZWwyMjMwNTEyOTQ=","Name":"approved"}},{"Label":{"ID":"MDU6TGFiZWw4NTg0NDc5Njk=","Name":"lifecycle/rotten"}},{"Label":{"ID":"MDU6TGFiZWwzNjQ1MjMzODE=","Name":"needs-api-review"}},{"Label":{"ID":"MDU6TGFiZWwyNzY3MDgwMTI=","Name":"needs-rebase"}},{"Label":{"ID":"MDU6TGFiZWw2NDA1NDg2NjI=","Name":"size/XXL"}}]},"Milestone":{"ID":null,"Closed":false}}]}' > pr-data.js
bazel run --run_under="cd $DIR && " //prow/cmd/deck:deck -- --run-local "$@"
